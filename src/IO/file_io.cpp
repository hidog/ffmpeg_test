#include "file_io.h"
#include "tool.h"



/*******************************************************************************
FileIO::FileIO()
********************************************************************************/
FileIO::FileIO( IO_Direction dir )
    :   InputOutput(dir)
{}





/*******************************************************************************
FileIO::~FileIO()
********************************************************************************/
FileIO::~FileIO()
{}




/*******************************************************************************
FileIO::init()
********************************************************************************/
void    FileIO::init()
{}





/*******************************************************************************
FileIO::init()
********************************************************************************/
void    FileIO::close()
{
    fclose(fp);
    fp  =   nullptr;
}



    
/*******************************************************************************
FileIO::open()
********************************************************************************/
void    FileIO::open()
{
    DecodeSetting&  setting     =   get_setting();
    std::string     filename    =   setting.filename;

    MYLOG( LOG::INFO, "load file %s", filename.c_str() );
    fp  =   fopen( filename.c_str(), "rb" );
    if( fp == nullptr )
        MYLOG( LOG::ERROR, "open file fail." );
}





/*******************************************************************************
FileIO::read()
********************************************************************************/
int     FileIO::read( uint8_t *buf, int buf_size )
{
    if( fp == nullptr )
        MYLOG( LOG::ERROR, "fp not open." );

    if( feof(fp) != 0 )
        return  EOF;

    int ret     =   fread( buf, 1, buf_size, fp );

    return ret;
}
